<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>安卓学习复习笔记 | 氧吧</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">安卓学习复习笔记</h1><a id="logo" href="/.">氧吧</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">安卓学习复习笔记</h1><div class="post-meta">Sep 8, 2015<span> | </span><span class="category"><a href="/categories/“Android”/">“Android”</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#进入应用程序主界面"><span class="toc-number">1.</span> <span class="toc-text">进入应用程序主界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取版本号版本名称"><span class="toc-number">2.</span> <span class="toc-text">获取版本号版本名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#系统弹窗的使用"><span class="toc-number">3.</span> <span class="toc-text">系统弹窗的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#判断sd卡是否可用，是否挂载上及SD卡路径"><span class="toc-number">4.</span> <span class="toc-text">判断sd卡是否可用，是否挂载上及SD卡路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新安装apk代码"><span class="toc-number">5.</span> <span class="toc-text">更新安装apk代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取SIM卡序列号"><span class="toc-number">6.</span> <span class="toc-text">获取SIM卡序列号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取联系人列表"><span class="toc-number">7.</span> <span class="toc-text">获取联系人列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移入移出动画"><span class="toc-number">8.</span> <span class="toc-text">移入移出动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图片选择器（普通、高亮）"><span class="toc-number">9.</span> <span class="toc-text">图片选择器（普通、高亮）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义控件属性的添加"><span class="toc-number">10.</span> <span class="toc-text">自定义控件属性的添加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取可用空间的大小"><span class="toc-number">11.</span> <span class="toc-text">获取可用空间的大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#卸载应用"><span class="toc-number">12.</span> <span class="toc-text">卸载应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开启应用"><span class="toc-number">13.</span> <span class="toc-text">开启应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发送短信"><span class="toc-number">14.</span> <span class="toc-text">发送短信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动画集合（缩放，透明）"><span class="toc-number">15.</span> <span class="toc-text">动画集合（缩放，透明）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ListView的使用（复用）"><span class="toc-number">16.</span> <span class="toc-text">ListView的使用（复用）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码更改布局位置处理"><span class="toc-number">17.</span> <span class="toc-text">代码更改布局位置处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取系统联系人"><span class="toc-number">18.</span> <span class="toc-text">获取系统联系人</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基类手势控制-上一页下一页"><span class="toc-number">19.</span> <span class="toc-text">基类手势控制 上一页下一页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#手机震动"><span class="toc-number">20.</span> <span class="toc-text">手机震动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#播放声音"><span class="toc-number">21.</span> <span class="toc-text">播放声音</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文本抖动效果"><span class="toc-number">22.</span> <span class="toc-text">文本抖动效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取手机所有应用相关信息"><span class="toc-number">23.</span> <span class="toc-text">获取手机所有应用相关信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#九宫格GridView"><span class="toc-number">24.</span> <span class="toc-text">九宫格GridView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取空间内存（运存）大小"><span class="toc-number">25.</span> <span class="toc-text">获取空间内存（运存）大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#判断服务是否开启"><span class="toc-number">26.</span> <span class="toc-text">判断服务是否开启</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多击事件"><span class="toc-number">27.</span> <span class="toc-text">多击事件</span></a></li></ol></div></div><div class="post-content"><h3 id="进入应用程序主界面"><a href="#进入应用程序主界面" class="headerlink" title="进入应用程序主界面"></a>进入应用程序主界面</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 进入应用程序主界面</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">enterHome</span><span class="params">()</span> </span>&#123;</div><div class="line">	Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>,HomeActivity.class);</div><div class="line">	startActivity(intent);</div><div class="line">	<span class="comment">//在开启一个新的界面后,将导航界面关闭(导航界面只可见一次)</span></div><div class="line">	finish();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="获取版本号版本名称"><a href="#获取版本号版本名称" class="headerlink" title="获取版本号版本名称"></a>获取版本号版本名称</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">	 * 返回版本号</div><div class="line">	 * <span class="doctag">@return</span>	</div><div class="line">	 * 			非0 则代表获取成功</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getVersionCode</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">//1,包管理者对象packageManager</span></div><div class="line">		PackageManager pm = getPackageManager();</div><div class="line">		<span class="comment">//2,从包的管理者对象中,获取指定包名的基本信息(版本名称,版本号),传0代表获取基本信息</span></div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			PackageInfo packageInfo = pm.getPackageInfo(getPackageName(), <span class="number">0</span>);</div><div class="line">			<span class="comment">//3,获取版本名称</span></div><div class="line">			<span class="keyword">return</span> packageInfo.versionCode;</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 获取版本名称:清单文件中</div><div class="line">	 * <span class="doctag">@return</span>	应用版本名称	返回null代表异常</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">getVersionName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">//1,包管理者对象packageManager</span></div><div class="line">		PackageManager pm = getPackageManager();</div><div class="line">		<span class="comment">//2,从包的管理者对象中,获取指定包名的基本信息(版本名称,版本号),传0代表获取基本信息</span></div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			PackageInfo packageInfo = pm.getPackageInfo(getPackageName(), <span class="number">0</span>);</div><div class="line">			<span class="comment">//3,获取版本名称</span></div><div class="line">			<span class="keyword">return</span> packageInfo.versionName;</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="系统弹窗的使用"><a href="#系统弹窗的使用" class="headerlink" title="系统弹窗的使用"></a>系统弹窗的使用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">	 * 弹出对话框,提示用户更新</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">showUpdateDialog</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">//对话框,是依赖于activity存在的</span></div><div class="line">		Builder builder = <span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>);</div><div class="line">		<span class="comment">//设置左上角图标</span></div><div class="line">		builder.setIcon(R.drawable.ic_launcher);</div><div class="line">		builder.setTitle(<span class="string">"版本更新"</span>);</div><div class="line">		<span class="comment">//设置描述内容</span></div><div class="line">		builder.setMessage(mVersionDes);</div><div class="line">		</div><div class="line">		<span class="comment">//积极按钮,立即更新</span></div><div class="line">		builder.setPositiveButton(<span class="string">"立即更新"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line">				<span class="comment">//下载apk,apk链接地址,downloadUrl</span></div><div class="line">				downloadApk();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		builder.setNegativeButton(<span class="string">"稍后再说"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line">				<span class="comment">//取消对话框,进入主界面</span></div><div class="line">				enterHome();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		<span class="comment">//点击取消事件监听</span></div><div class="line">		builder.setOnCancelListener(<span class="keyword">new</span> DialogInterface.OnCancelListener() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCancel</span><span class="params">(DialogInterface dialog)</span> </span>&#123;</div><div class="line">				<span class="comment">//即使用户点击取消,也需要让其进入应用程序主界面</span></div><div class="line">				enterHome();</div><div class="line">				dialog.dismiss();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		builder.show();</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="判断sd卡是否可用，是否挂载上及SD卡路径"><a href="#判断sd卡是否可用，是否挂载上及SD卡路径" class="headerlink" title="判断sd卡是否可用，是否挂载上及SD卡路径"></a>判断sd卡是否可用，是否挂载上及SD卡路径</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1,判断sd卡是否可用,是否挂在上</span></div><div class="line">		<span class="keyword">if</span>(Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED))&#123;</div><div class="line">			<span class="comment">//2,获取sd路径</span></div><div class="line">			String path = 			Environment.getExternalStorageDirectory().getAbsolutePath()</div><div class="line">					+File.separator+<span class="string">"xxx.apk"</span>;</div><div class="line">					&#125;</div></pre></td></tr></table></figure>
<h3 id="更新安装apk代码"><a href="#更新安装apk代码" class="headerlink" title="更新安装apk代码"></a>更新安装apk代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 安装对应apk</div><div class="line">	 * <span class="doctag">@param</span> file	安装文件</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">installApk</span><span class="params">(File file)</span> </span>&#123;</div><div class="line">		<span class="comment">//系统应用界面,源码,安装apk入口</span></div><div class="line">		Intent intent = <span class="keyword">new</span> Intent(<span class="string">"android.intent.action.VIEW"</span>);</div><div class="line">		intent.addCategory(<span class="string">"android.intent.category.DEFAULT"</span>);</div><div class="line">		<span class="comment">/*//文件作为数据源</span></div><div class="line">		intent.setData(Uri.fromFile(file));</div><div class="line">		//设置安装的类型</div><div class="line">		intent.setType("application/vnd.android.package-archive");*/</div><div class="line">		intent.setDataAndType(Uri.fromFile(file),<span class="string">"application/vnd.android.package-archive"</span>);</div><div class="line"><span class="comment">//		startActivity(intent);</span></div><div class="line">		startActivityForResult(intent, <span class="number">0</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">//开启一个activity后,返回结果调用的方法 取消安装的回掉</span></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</div><div class="line">		enterHome();</div><div class="line">		<span class="keyword">super</span>.onActivityResult(requestCode, resultCode, data);</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="获取SIM卡序列号"><a href="#获取SIM卡序列号" class="headerlink" title="获取SIM卡序列号"></a>获取SIM卡序列号</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取sim卡序列号TelephoneManager</span></div><div class="line">TelephonyManager manager = (TelephonyManager)</div><div class="line">								getSystemService(Context.TELEPHONY_SERVICE);</div><div class="line">		</div><div class="line">String simSerialNumber = manager.getSimSerialNumber();</div></pre></td></tr></table></figure>
<h3 id="获取联系人列表"><a href="#获取联系人列表" class="headerlink" title="获取联系人列表"></a>获取联系人列表</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> android.app.Activity;</div><div class="line"><span class="keyword">import</span> android.content.ContentResolver;</div><div class="line"><span class="keyword">import</span> android.content.Intent;</div><div class="line"><span class="keyword">import</span> android.database.Cursor;</div><div class="line"><span class="keyword">import</span> android.net.Uri;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.os.Handler;</div><div class="line"><span class="keyword">import</span> android.text.TextUtils;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.view.ViewGroup;</div><div class="line"><span class="keyword">import</span> android.widget.AdapterView;</div><div class="line"><span class="keyword">import</span> android.widget.AdapterView.OnItemClickListener;</div><div class="line"><span class="keyword">import</span> android.widget.BaseAdapter;</div><div class="line"><span class="keyword">import</span> android.widget.ListView;</div><div class="line"><span class="keyword">import</span> android.widget.TextView;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContactListActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> String tag = <span class="string">"ContactListActivity"</span>;</div><div class="line">	<span class="keyword">private</span> ListView lv_contact;</div><div class="line">	<span class="keyword">private</span> List&lt;HashMap&lt;String,String&gt;&gt; contactList = <span class="keyword">new</span> ArrayList&lt;HashMap&lt;String,String&gt;&gt;();</div><div class="line">	<span class="keyword">private</span> MyAdapter mAdapter;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler()&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(android.os.Message msg)</span> </span>&#123;</div><div class="line">			<span class="comment">//8,填充数据适配器</span></div><div class="line">			</div><div class="line">			mAdapter = <span class="keyword">new</span> MyAdapter();</div><div class="line">			lv_contact.setAdapter(mAdapter);</div><div class="line">		&#125;;</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">		setContentView(R.layout.activity_contact_list);</div><div class="line">		</div><div class="line">		initUI();</div><div class="line">		initData();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span></span>&#123;</div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> contactList.size();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> HashMap&lt;String, String&gt; <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> contactList.get(position);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> position;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</div><div class="line">			View view = View.inflate(getApplicationContext(), R.layout.listview_contact_item, <span class="keyword">null</span>);</div><div class="line">			</div><div class="line">			TextView tv_name = (TextView) view.findViewById(R.id.tv_name);</div><div class="line">			TextView tv_phone = (TextView) view.findViewById(R.id.tv_phone);</div><div class="line">			</div><div class="line">			tv_name.setText(getItem(position).get(<span class="string">"name"</span>));</div><div class="line">			tv_phone.setText(getItem(position).get(<span class="string">"phone"</span>));</div><div class="line">			</div><div class="line">			<span class="keyword">return</span> view;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 获取系统联系人数据方法</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">//因为读取系统联系人,可能是一个耗时操作,放置到子线程中处理</span></div><div class="line">		<span class="keyword">new</span> Thread()&#123;</div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">				<span class="comment">//1,获取内容解析器对象</span></div><div class="line">				ContentResolver contentResolver = getContentResolver();</div><div class="line">				<span class="comment">//2,做查询系统联系人数据库表过程(读取联系人权限)</span></div><div class="line">				Cursor cursor = contentResolver.query(</div><div class="line">						Uri.parse(<span class="string">"content://com.android.contacts/raw_contacts"</span>),</div><div class="line">						<span class="keyword">new</span> String[]&#123;<span class="string">"contact_id"</span>&#125;, </div><div class="line">						<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">				contactList.clear();</div><div class="line">				<span class="comment">//3,循环游标,直到没有数据为止</span></div><div class="line">				<span class="keyword">while</span>(cursor.moveToNext())&#123;</div><div class="line">					String id = cursor.getString(<span class="number">0</span>);</div><div class="line"><span class="comment">//					Log.i(tag, "id = "+id);</span></div><div class="line">					<span class="comment">//4,根据用户唯一性id值,查询data表和mimetype表生成的视图,获取data以及mimetype字段</span></div><div class="line">					Cursor indexCursor = contentResolver.query(</div><div class="line">							Uri.parse(<span class="string">"content://com.android.contacts/data"</span>), </div><div class="line">							<span class="keyword">new</span> String[]&#123;<span class="string">"data1"</span>,<span class="string">"mimetype"</span>&#125;, </div><div class="line">							<span class="string">"raw_contact_id = ?"</span>, <span class="keyword">new</span> String[]&#123;id&#125;, <span class="keyword">null</span>);</div><div class="line">					<span class="comment">//5,循环获取每一个联系人的电话号码以及姓名,数据类型</span></div><div class="line">					HashMap&lt;String, String&gt; hashMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">					<span class="keyword">while</span>(indexCursor.moveToNext())&#123;</div><div class="line">						String data = indexCursor.getString(<span class="number">0</span>);	</div><div class="line">						String type = indexCursor.getString(<span class="number">1</span>);</div><div class="line">						</div><div class="line">						<span class="comment">//6,区分类型去给hashMap填充数据</span></div><div class="line">						<span class="keyword">if</span>(type.equals(<span class="string">"vnd.android.cursor.item/phone_v2"</span>))&#123;</div><div class="line">							<span class="comment">//数据非空判断</span></div><div class="line">							<span class="keyword">if</span>(!TextUtils.isEmpty(data))&#123;</div><div class="line">								hashMap.put(<span class="string">"phone"</span>, data);</div><div class="line">							&#125;</div><div class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>(type.equals(<span class="string">"vnd.android.cursor.item/name"</span>))&#123;</div><div class="line">							<span class="keyword">if</span>(!TextUtils.isEmpty(data))&#123;</div><div class="line">								hashMap.put(<span class="string">"name"</span>, data);</div><div class="line">							&#125;</div><div class="line">						&#125;</div><div class="line">					&#125;</div><div class="line">					indexCursor.close();</div><div class="line">					contactList.add(hashMap);</div><div class="line">				&#125;</div><div class="line">				cursor.close();</div><div class="line">				<span class="comment">//7,消息机制,发送一个空的消息,告知主线程可以去使用子线程已经填充好的数据集合</span></div><div class="line">				mHandler.sendEmptyMessage(<span class="number">0</span>);</div><div class="line">			&#125;;</div><div class="line">		&#125;.start();</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUI</span><span class="params">()</span> </span>&#123;</div><div class="line">		lv_contact = (ListView) findViewById(R.id.lv_contact);</div><div class="line">		lv_contact.setOnItemClickListener(<span class="keyword">new</span> OnItemClickListener() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; parent, View view,<span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</div><div class="line">				<span class="comment">//1,获取点中条目的索引指向集合中的对象</span></div><div class="line">				<span class="keyword">if</span>(mAdapter!=<span class="keyword">null</span>)&#123;</div><div class="line">					HashMap&lt;String, String&gt; hashMap = mAdapter.getItem(position);</div><div class="line">					<span class="comment">//2,获取当前条目指向集合对应的电话号码</span></div><div class="line">					String phone = hashMap.get(<span class="string">"phone"</span>);</div><div class="line">					<span class="comment">//3,此电话号码需要给第三个导航界面使用</span></div><div class="line">					</div><div class="line">					<span class="comment">//4,在结束此界面回到前一个导航界面的时候,需要将数据返回过去</span></div><div class="line">					Intent intent = <span class="keyword">new</span> Intent();</div><div class="line">					intent.putExtra(<span class="string">"phone"</span>, phone);</div><div class="line">					setResult(<span class="number">0</span>, intent);</div><div class="line">					</div><div class="line">					finish();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="移入移出动画"><a href="#移入移出动画" class="headerlink" title="移入移出动画"></a>移入移出动画</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">//动画XML创建 res/anim/xxx.xml</div><div class="line">//next_in_anim.xml</div><div class="line">&lt;translate</div><div class="line">    xmlns:android="http://schemas.android.com/apk/res/android"</div><div class="line">    android:fromXDelta="100%p"</div><div class="line">    android:toXDelta="0"</div><div class="line">    android:duration="500"&gt;</div><div class="line">&lt;/translate&gt;</div><div class="line"></div><div class="line">//next_out_anim.xml</div><div class="line">&lt;translate</div><div class="line">    xmlns:android="http://schemas.android.com/apk/res/android"</div><div class="line">    android:fromXDelta="0"</div><div class="line">    android:toXDelta="-100%p"</div><div class="line">    android:duration="500"&gt;</div><div class="line">&lt;/translate&gt;</div><div class="line"></div><div class="line">//pre_in_anim.xml</div><div class="line">&lt;!-- -100%p 负一屏幕的宽度大小值 --&gt;</div><div class="line">&lt;translate</div><div class="line">    xmlns:android="http://schemas.android.com/apk/res/android"</div><div class="line">    android:fromXDelta="-100%p"</div><div class="line">    android:toXDelta="0"</div><div class="line">    android:duration="500"&gt;</div><div class="line">&lt;/translate&gt;</div><div class="line"></div><div class="line">//pre_out_anim.xml</div><div class="line">&lt;translate</div><div class="line">    xmlns:android="http://schemas.android.com/apk/res/android"</div><div class="line">    android:fromXDelta="0"</div><div class="line">    android:toXDelta="100%p"</div><div class="line">    android:duration="500"&gt;</div><div class="line">&lt;/translate&gt;</div><div class="line"></div><div class="line">overridePendingTransition(R.anim.next_in_anim, R.anim.next_out_anim);</div></pre></td></tr></table></figure>
<h3 id="图片选择器（普通、高亮）"><a href="#图片选择器（普通、高亮）" class="headerlink" title="图片选择器（普通、高亮）"></a>图片选择器（普通、高亮）</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//selector xml 创建res/drawable/selector_xxx_xxx.xml</div><div class="line">&lt;selector xmlns:android="http://schemas.android.com/apk/res/android" &gt;</div><div class="line">    &lt;!-- 选中深绿色图片 --&gt;</div><div class="line">	&lt;item android:state_pressed="true"	android:drawable="@drawable/function_greenbutton_pressed"/&gt;</div><div class="line">	&lt;!-- 浅绿色的图片 --&gt;</div><div class="line">	&lt;item android:drawable="@drawable/function_greenbutton_normal"/&gt;</div><div class="line">&lt;/selector&gt;</div></pre></td></tr></table></figure>
<h3 id="自定义控件属性的添加"><a href="#自定义控件属性的添加" class="headerlink" title="自定义控件属性的添加"></a>自定义控件属性的添加</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//attrs.xml创建  res/values/attrs.xml</div><div class="line">&lt;resources&gt;</div><div class="line">    &lt;declare-styleable name="com.xxx.view.SettingItemView"&gt;</div><div class="line">		&lt;attr name="destitle" format="string"/&gt;</div><div class="line">		&lt;attr name="desoff" format="string"/&gt;</div><div class="line">		&lt;attr name="deson" format="string"/&gt;</div><div class="line">	&lt;/declare-styleable&gt;</div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
<h3 id="获取可用空间的大小"><a href="#获取可用空间的大小" class="headerlink" title="获取可用空间的大小"></a>获取可用空间的大小</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//1,获取磁盘(内存,区分于手机运行内存)可用大小,磁盘路径</span></div><div class="line">		String path = Environment.getDataDirectory().getAbsolutePath();</div><div class="line">		<span class="comment">//2,获取sd卡可用大小,sd卡路径</span></div><div class="line">		String sdPath = Environment.getExternalStorageDirectory().getAbsolutePath();</div><div class="line">		<span class="comment">//3,获取以上两个路径下文件夹的可用大小</span></div><div class="line">		String memoryAvailSpace = Formatter.formatFileSize(<span class="keyword">this</span>, getAvailSpace(path));</div><div class="line">		String sdMemoryAvailSpace = Formatter.formatFileSize(<span class="keyword">this</span>,getAvailSpace(sdPath));</div><div class="line"></div><div class="line"><span class="comment">//int代表多少个G	</span></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * 返回值结果单位为byte = 8bit,最大结果为2147483647 bytes</div><div class="line">	 * <span class="doctag">@param</span> path</div><div class="line">	 * <span class="doctag">@return</span>	返回指定路径可用区域的byte类型值</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getAvailSpace</span><span class="params">(String path)</span> </span>&#123;</div><div class="line">		<span class="comment">//获取可用磁盘大小类</span></div><div class="line">		StatFs statFs = <span class="keyword">new</span> StatFs(path);</div><div class="line">		<span class="comment">//获取可用区块的个数</span></div><div class="line">		<span class="keyword">long</span> count = statFs.getAvailableBlocks();</div><div class="line">		<span class="comment">//获取区块的大小</span></div><div class="line">		<span class="keyword">long</span> size = statFs.getBlockSize();</div><div class="line">		<span class="comment">//区块大小*可用区块个数 == 可用空间大小</span></div><div class="line">		<span class="keyword">return</span> count*size;</div><div class="line"><span class="comment">//		Integer.MAX_VALUE	代表int类型数据的最大大小</span></div><div class="line"><span class="comment">//		0x7FFFFFFF</span></div><div class="line"><span class="comment">//		</span></div><div class="line"><span class="comment">//		2147483647bytes/1024 =  2096128 KB</span></div><div class="line"><span class="comment">//		2096128KB/1024 = 2047	MB</span></div><div class="line"><span class="comment">//		2047MB = 2G</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="卸载应用"><a href="#卸载应用" class="headerlink" title="卸载应用"></a>卸载应用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Intent intent = <span class="keyword">new</span> Intent(<span class="string">"android.intent.action.DELETE"</span>);</div><div class="line">intent.addCategory(<span class="string">"android.intent.category.DEFAULT"</span>);</div><div class="line">intent.setData(Uri.parse(<span class="string">"package:"</span>+mAppInfo.getPackageName()));</div><div class="line">startActivity(intent);</div></pre></td></tr></table></figure>
<h3 id="开启应用"><a href="#开启应用" class="headerlink" title="开启应用"></a>开启应用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通过桌面去启动指定包名应用</span></div><div class="line">PackageManager pm = getPackageManager();</div><div class="line"><span class="comment">//通过Launch开启制定包名的意图,去开启应用</span></div><div class="line">Intent launchIntentForPackage = pm.getLaunchIntentForPackage(mAppInfo.getPackageName());</div><div class="line"><span class="keyword">if</span>(launchIntentForPackage!=<span class="keyword">null</span>)&#123;</div><div class="line">    startActivity(launchIntentForPackage);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    ToastUtil.show(getApplicationContext(), <span class="string">"此应用不能被开启"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="发送短信"><a href="#发送短信" class="headerlink" title="发送短信"></a>发送短信</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_SEND);</div><div class="line">intent.putExtra(Intent.EXTRA_TEXT,<span class="string">"分享一个应用,应用名称为"</span>+mAppInfo.getName());</div><div class="line">intent.setType(<span class="string">"text/plain"</span>);</div><div class="line">startActivity(intent);</div></pre></td></tr></table></figure>
<h3 id="动画集合（缩放，透明）"><a href="#动画集合（缩放，透明）" class="headerlink" title="动画集合（缩放，透明）"></a>动画集合（缩放，透明）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//透明动画(透明---&gt;不透明)</span></div><div class="line">AlphaAnimation alphaAnimation = <span class="keyword">new</span> AlphaAnimation(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line">alphaAnimation.setDuration(<span class="number">1000</span>);</div><div class="line">alphaAnimation.setFillAfter(<span class="keyword">true</span>);</div><div class="line"></div><div class="line"><span class="comment">//缩放动画</span></div><div class="line">ScaleAnimation scaleAnimation = <span class="keyword">new</span> ScaleAnimation(</div><div class="line">      <span class="number">0</span>, <span class="number">1</span>, </div><div class="line">      <span class="number">0</span>, <span class="number">1</span>, </div><div class="line">      Animation.RELATIVE_TO_SELF, <span class="number">0.5f</span>, </div><div class="line">      Animation.RELATIVE_TO_SELF, <span class="number">0.5f</span>);</div><div class="line">scaleAnimation.setDuration(<span class="number">1000</span>);</div><div class="line">alphaAnimation.setFillAfter(<span class="keyword">true</span>);</div><div class="line"><span class="comment">//动画集合Set</span></div><div class="line">AnimationSet animationSet = <span class="keyword">new</span> AnimationSet(<span class="keyword">true</span>);</div><div class="line"><span class="comment">//添加两个动画</span></div><div class="line">animationSet.addAnimation(alphaAnimation);</div><div class="line">animationSet.addAnimation(scaleAnimation);</div><div class="line"></div><div class="line"><span class="comment">//view执行动画</span></div><div class="line">view.startAnimation(animationSet);</div></pre></td></tr></table></figure>
<h3 id="ListView的使用（复用）"><a href="#ListView的使用（复用）" class="headerlink" title="ListView的使用（复用）"></a>ListView的使用（复用）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1,复用convertView</span></div><div class="line"><span class="comment">//2,对findViewById次数的优化,使用ViewHolder</span></div><div class="line"><span class="comment">//3,将ViewHolder定义成静态,不会去创建多个对象</span></div><div class="line"><span class="comment">//4,listView如果有多个条目的时候,可以做分页算法,每一次加载20条,逆序返回</span></div><div class="line"></div><div class="line"><span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler()&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(android.os.Message msg)</span> </span>&#123;</div><div class="line">			mAdapter = <span class="keyword">new</span> MyAdapter();</div><div class="line">			lv_app_list.setAdapter(mAdapter);</div><div class="line">		&#125;;</div><div class="line">	&#125;;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span></span>&#123;</div><div class="line">   </div><div class="line">   <span class="comment">//获取数据适配器中条目类型的总数,修改成两种(纯文本,图片+文字)</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getViewTypeCount</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">super</span>.getViewTypeCount()+<span class="number">1</span>;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="comment">//指定索引指向的条目类型,条目类型状态码指定(0(复用系统),1)</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemViewType</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">      <span class="keyword">if</span>(position == <span class="number">0</span> || position == mCustomerList.size()+<span class="number">1</span>)&#123;</div><div class="line">         <span class="comment">//返回0,代表纯文本条目的状态码</span></div><div class="line">         <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">         <span class="comment">//返回1,代表图片+文本条目状态码</span></div><div class="line">         <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="comment">//listView中添加两个描述条目</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> mCustomerList.size()+mSystemList.size()+<span class="number">2</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> AppInfo <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">      <span class="keyword">if</span>(position == <span class="number">0</span> || position == mCustomerList.size()+<span class="number">1</span>)&#123;</div><div class="line">         <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">         <span class="keyword">if</span>(position&lt;mCustomerList.size()+<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">return</span> mCustomerList.get(position-<span class="number">1</span>);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">//返回系统应用对应条目的对象</span></div><div class="line">            <span class="keyword">return</span> mSystemList.get(position - mCustomerList.size()-<span class="number">2</span>);</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> position;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</div><div class="line">      <span class="keyword">int</span> type = getItemViewType(position);</div><div class="line">      </div><div class="line">      <span class="keyword">if</span>(type == <span class="number">0</span>)&#123;</div><div class="line">         <span class="comment">//展示灰色纯文本条目</span></div><div class="line">         ViewTitleHolder holder = <span class="keyword">null</span>;</div><div class="line">         <span class="keyword">if</span>(convertView == <span class="keyword">null</span>)&#123;</div><div class="line">            convertView = View.inflate(getApplicationContext(), R.layout.listview_app_item_title, <span class="keyword">null</span>);</div><div class="line">            holder = <span class="keyword">new</span> ViewTitleHolder();</div><div class="line">            holder.tv_title = (TextView)convertView.findViewById(R.id.tv_title);</div><div class="line">            convertView.setTag(holder);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            holder = (ViewTitleHolder) convertView.getTag();</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span>(position == <span class="number">0</span>)&#123;</div><div class="line">            holder.tv_title.setText(<span class="string">"用户应用("</span>+mCustomerList.size()+<span class="string">")"</span>);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            holder.tv_title.setText(<span class="string">"系统应用("</span>+mSystemList.size()+<span class="string">")"</span>);</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">return</span> convertView;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">         <span class="comment">//展示图片+文字条目</span></div><div class="line">         ViewHolder holder = <span class="keyword">null</span>;</div><div class="line">         <span class="keyword">if</span>(convertView == <span class="keyword">null</span>)&#123;</div><div class="line">            convertView = View.inflate(getApplicationContext(), R.layout.listview_app_item, <span class="keyword">null</span>);</div><div class="line">            holder = <span class="keyword">new</span> ViewHolder();</div><div class="line">            holder.iv_icon = (ImageView)convertView.findViewById(R.id.iv_icon);</div><div class="line">            holder.tv_name = (TextView)convertView.findViewById(R.id.tv_name);</div><div class="line">            holder.tv_path = (TextView) convertView.findViewById(R.id.tv_path);</div><div class="line">            convertView.setTag(holder);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            holder = (ViewHolder) convertView.getTag();</div><div class="line">         &#125;</div><div class="line">         holder.iv_icon.setBackgroundDrawable(getItem(position).icon);</div><div class="line">         holder.tv_name.setText(getItem(position).name);</div><div class="line">         <span class="keyword">if</span>(getItem(position).isSdCard)&#123;</div><div class="line">            holder.tv_path.setText(<span class="string">"sd卡应用"</span>);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            holder.tv_path.setText(<span class="string">"手机应用"</span>);</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">return</span> convertView;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>&#123;</div><div class="line">   ImageView iv_icon;</div><div class="line">   TextView tv_name;</div><div class="line">   TextView tv_path;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewTitleHolder</span></span>&#123;</div><div class="line">   TextView tv_title;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initList</span><span class="params">()</span> </span>&#123;</div><div class="line">		lv_app_list = (ListView) findViewById(R.id.lv_app_list);</div><div class="line">		tv_des = (TextView) findViewById(R.id.tv_des);</div><div class="line"></div><div class="line">  		<span class="comment">//悬浮设置</span></div><div class="line">  		lv_app_list.setOnScrollListener(<span class="keyword">new</span> OnScrollListener() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrollStateChanged</span><span class="params">(AbsListView view, <span class="keyword">int</span> scrollState)</span> </span>&#123;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScroll</span><span class="params">(AbsListView view, <span class="keyword">int</span> firstVisibleItem,</span></span></div><div class="line">					<span class="keyword">int</span> visibleItemCount, <span class="keyword">int</span> totalItemCount) &#123;</div><div class="line">				<span class="comment">//滚动过程中调用方法</span></div><div class="line">				<span class="comment">//AbsListView中view就是listView对象</span></div><div class="line">				<span class="comment">//firstVisibleItem第一个可见条目索引值</span></div><div class="line">				<span class="comment">//visibleItemCount当前一个屏幕的可见条目数</span></div><div class="line">				<span class="comment">//总共条目总数</span></div><div class="line">				<span class="keyword">if</span>(mCustomerList!=<span class="keyword">null</span> &amp;&amp; mSystemList!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">if</span>(firstVisibleItem&gt;=mCustomerList.size()+<span class="number">1</span>)&#123;</div><div class="line">						<span class="comment">//滚动到了系统条目</span></div><div class="line">						tv_des.setText(<span class="string">"系统应用("</span>+mSystemList.size()+<span class="string">")"</span>);</div><div class="line">					&#125;<span class="keyword">else</span>&#123;</div><div class="line">						<span class="comment">//滚动到了用户应用条目</span></div><div class="line">						tv_des.setText(<span class="string">"用户应用("</span>+mCustomerList.size()+<span class="string">")"</span>);</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###拖拽跟随移动的处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//监听某一个控件的拖拽过程(按下(1),移动(多次),抬起(1))</span></div><div class="line">iv_drag.setOnTouchListener(<span class="keyword">new</span> OnTouchListener() &#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> startX;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> startY;</div><div class="line">   <span class="comment">//对不同的事件做不同的逻辑处理</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</div><div class="line">      <span class="keyword">switch</span> (event.getAction()) &#123;</div><div class="line">      <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">         startX = (<span class="keyword">int</span>) event.getRawX();</div><div class="line">         startY = (<span class="keyword">int</span>) event.getRawY();</div><div class="line">         <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">         <span class="keyword">int</span> moveX = (<span class="keyword">int</span>) event.getRawX();</div><div class="line">         <span class="keyword">int</span> moveY = (<span class="keyword">int</span>) event.getRawY();</div><div class="line">         </div><div class="line">         <span class="keyword">int</span> disX = moveX-startX;</div><div class="line">         <span class="keyword">int</span> disY = moveY-startY;</div><div class="line">         </div><div class="line">         <span class="comment">//1,当前控件所在屏幕的(左,上)角的位置</span></div><div class="line">         <span class="keyword">int</span> left = iv_drag.getLeft()+disX;<span class="comment">//左侧坐标</span></div><div class="line">         <span class="keyword">int</span> top = iv_drag.getTop()+disY;<span class="comment">//顶端坐标</span></div><div class="line">         <span class="keyword">int</span> right = iv_drag.getRight()+disX;<span class="comment">//右侧坐标</span></div><div class="line">         <span class="keyword">int</span> bottom = iv_drag.getBottom()+disY;<span class="comment">//底部坐标</span></div><div class="line">         </div><div class="line">         <span class="comment">//容错处理(iv_drag不能拖拽出手机屏幕)</span></div><div class="line">         <span class="comment">//左边缘不能超出屏幕</span></div><div class="line">         <span class="keyword">if</span>(left&lt;<span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="comment">//右边边缘不能超出屏幕</span></div><div class="line">         <span class="keyword">if</span>(right&gt;mScreenWidth)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="comment">//上边缘不能超出屏幕可现实区域</span></div><div class="line">         <span class="keyword">if</span>(top&lt;<span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="comment">//下边缘(屏幕的高度-22 = 底边缘显示最大值)</span></div><div class="line">         <span class="keyword">if</span>(bottom&gt;mScreenHeight - <span class="number">22</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="keyword">if</span>(top&gt;mScreenHeight/<span class="number">2</span>)&#123;</div><div class="line">            bt_bottom.setVisibility(View.INVISIBLE);</div><div class="line">            bt_top.setVisibility(View.VISIBLE);</div><div class="line">         &#125;<span class="keyword">else</span>&#123;</div><div class="line">            bt_bottom.setVisibility(View.VISIBLE);</div><div class="line">            bt_top.setVisibility(View.INVISIBLE);</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="comment">//2,告知移动的控件,按计算出来的坐标去做展示</span></div><div class="line">         iv_drag.layout(left, top, right, bottom);</div><div class="line">         </div><div class="line">         <span class="comment">//3,重置一次其实坐标</span></div><div class="line">         startX = (<span class="keyword">int</span>) event.getRawX();</div><div class="line">         startY = (<span class="keyword">int</span>) event.getRawY();</div><div class="line">         </div><div class="line">         <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">         <span class="comment">//4,存储移动到的位置</span></div><div class="line">         SpUtil.putInt(getApplicationContext(), ConstantValue.LOCATION_X, iv_drag.getLeft());</div><div class="line">         SpUtil.putInt(getApplicationContext(), ConstantValue.LOCATION_Y, iv_drag.getTop());</div><div class="line">         <span class="keyword">break</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">//在当前的情况下返回false不响应事件,返回true才会响应事件</span></div><div class="line">      </div><div class="line">      <span class="comment">//既要响应点击事件,又要响应拖拽过程,则此返回值结果需要修改为false</span></div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">   &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="代码更改布局位置处理"><a href="#代码更改布局位置处理" class="headerlink" title="代码更改布局位置处理"></a>代码更改布局位置处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取屏幕宽高</span></div><div class="line">mWM = (WindowManager) getSystemService(WINDOW_SERVICE);</div><div class="line">mScreenHeight = mWM.getDefaultDisplay().getHeight();</div><div class="line">mScreenWidth = mWM.getDefaultDisplay().getWidth();</div><div class="line"></div><div class="line"><span class="comment">//左上角坐标作用在iv_drag上</span></div><div class="line"><span class="comment">//iv_drag在相对布局中,所以其所在位置的规则需要由相对布局提供</span></div><div class="line"></div><div class="line"><span class="comment">//指定宽高都为WRAP_CONTENT</span></div><div class="line">LayoutParams layoutParams = <span class="keyword">new</span> RelativeLayout.LayoutParams(</div><div class="line">      RelativeLayout.LayoutParams.WRAP_CONTENT, </div><div class="line">      RelativeLayout.LayoutParams.WRAP_CONTENT);</div><div class="line"><span class="comment">//将左上角的坐标作用在iv_drag对应规则参数上</span></div><div class="line">layoutParams.leftMargin = locationX;</div><div class="line">layoutParams.topMargin = locationY;</div><div class="line"><span class="comment">//将以上规则作用在iv_drag上</span></div><div class="line">iv_drag.setLayoutParams(layoutParams);</div></pre></td></tr></table></figure>
<h3 id="获取系统联系人"><a href="#获取系统联系人" class="headerlink" title="获取系统联系人"></a>获取系统联系人</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">/**</span></div><div class="line">    * 获取系统联系人数据方法</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="comment">//因为读取系统联系人,可能是一个耗时操作,放置到子线程中处理</span></div><div class="line">      <span class="keyword">new</span> Thread()&#123;</div><div class="line">         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="comment">//1,获取内容解析器对象</span></div><div class="line">            ContentResolver contentResolver = getContentResolver();</div><div class="line">            <span class="comment">//2,做查询系统联系人数据库表过程(读取联系人权限)</span></div><div class="line">            Cursor cursor = contentResolver.query(</div><div class="line">                  Uri.parse(<span class="string">"content://com.android.contacts/raw_contacts"</span>),</div><div class="line">                  <span class="keyword">new</span> String[]&#123;<span class="string">"contact_id"</span>&#125;, </div><div class="line">                  <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">            contactList.clear();</div><div class="line">            <span class="comment">//3,循环游标,直到没有数据为止</span></div><div class="line">            <span class="keyword">while</span>(cursor.moveToNext())&#123;</div><div class="line">               String id = cursor.getString(<span class="number">0</span>);</div><div class="line"><span class="comment">//             Log.i(tag, "id = "+id);</span></div><div class="line">               <span class="comment">//4,根据用户唯一性id值,查询data表和mimetype表生成的视图,获取data以及mimetype字段</span></div><div class="line">               Cursor indexCursor = contentResolver.query(</div><div class="line">                     Uri.parse(<span class="string">"content://com.android.contacts/data"</span>), </div><div class="line">                     <span class="keyword">new</span> String[]&#123;<span class="string">"data1"</span>,<span class="string">"mimetype"</span>&#125;, </div><div class="line">                     <span class="string">"raw_contact_id = ?"</span>, <span class="keyword">new</span> String[]&#123;id&#125;, <span class="keyword">null</span>);</div><div class="line">               <span class="comment">//5,循环获取每一个联系人的电话号码以及姓名,数据类型</span></div><div class="line">               HashMap&lt;String, String&gt; hashMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">               <span class="keyword">while</span>(indexCursor.moveToNext())&#123;</div><div class="line">                  String data = indexCursor.getString(<span class="number">0</span>);    </div><div class="line">                  String type = indexCursor.getString(<span class="number">1</span>);</div><div class="line">                  </div><div class="line">                  <span class="comment">//6,区分类型去给hashMap填充数据</span></div><div class="line">                  <span class="keyword">if</span>(type.equals(<span class="string">"vnd.android.cursor.item/phone_v2"</span>))&#123;</div><div class="line">                     <span class="comment">//数据非空判断</span></div><div class="line">                     <span class="keyword">if</span>(!TextUtils.isEmpty(data))&#123;</div><div class="line">                        hashMap.put(<span class="string">"phone"</span>, data);</div><div class="line">                     &#125;</div><div class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type.equals(<span class="string">"vnd.android.cursor.item/name"</span>))&#123;</div><div class="line">                     <span class="keyword">if</span>(!TextUtils.isEmpty(data))&#123;</div><div class="line">                        hashMap.put(<span class="string">"name"</span>, data);</div><div class="line">                     &#125;</div><div class="line">                  &#125;</div><div class="line">               &#125;</div><div class="line">               indexCursor.close();</div><div class="line">               contactList.add(hashMap);</div><div class="line">            &#125;</div><div class="line">            cursor.close();</div><div class="line">            <span class="comment">//7,消息机制,发送一个空的消息,告知主线程可以去使用子线程已经填充好的数据集合</span></div><div class="line">            mHandler.sendEmptyMessage(<span class="number">0</span>);</div><div class="line">         &#125;;</div><div class="line">      &#125;.start();</div><div class="line">      </div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h3 id="基类手势控制-上一页下一页"><a href="#基类手势控制-上一页下一页" class="headerlink" title="基类手势控制 上一页下一页"></a>基类手势控制 上一页下一页</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">   <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">   </div><div class="line">   <span class="comment">//2,创建手势管理的对象,用作管理在onTouchEvent(event)传递过来的手势动作</span></div><div class="line">   gestureDetector = <span class="keyword">new</span> GestureDetector(<span class="keyword">this</span>, <span class="keyword">new</span> GestureDetector.SimpleOnGestureListener()&#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onFling</span><span class="params">(MotionEvent e1, MotionEvent e2,</span></span></div><div class="line">            <span class="keyword">float</span> velocityX, <span class="keyword">float</span> velocityY) &#123;</div><div class="line">         <span class="comment">//监听手势的移动</span></div><div class="line">         <span class="keyword">if</span>(e1.getX()-e2.getX()&gt;<span class="number">0</span>)&#123;</div><div class="line">            <span class="comment">//调用子类的下一页方法,抽象方法</span></div><div class="line">            </div><div class="line">            <span class="comment">//在第一个界面上的时候,跳转到第二个界面</span></div><div class="line">            <span class="comment">//在第二个界面上的时候,跳转到第三个界面</span></div><div class="line">            <span class="comment">//.......</span></div><div class="line">            showNextPage();</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="keyword">if</span>(e1.getX()-e2.getX()&lt;<span class="number">0</span>)&#123;</div><div class="line">            <span class="comment">//调用子类的上一页方法</span></div><div class="line">            <span class="comment">//在第一个界面上的时候,无响应,空实现</span></div><div class="line">            <span class="comment">//在第二个界面上的时候,跳转到第1个界面</span></div><div class="line">            <span class="comment">//.......</span></div><div class="line">            showPrePage();</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="keyword">return</span> <span class="keyword">super</span>.onFling(e1, e2, velocityX, velocityY);</div><div class="line">      &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">//1,监听屏幕上响应的事件类型(按下(1次),移动(多次),抬起(1次))</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">   <span class="comment">//3,通过手势处理类,接收多种类型的事件,用作处理</span></div><div class="line">   gestureDetector.onTouchEvent(event);</div><div class="line">   <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//下一页的抽象方法,由子类决定具体跳转到那个界面</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showNextPage</span><span class="params">()</span></span>;</div><div class="line"><span class="comment">//上一页的抽象方法,由子类决定具体跳转到那个界面</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showPrePage</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//点击下一页按钮的时候,根据子类的showNextPage方法做相应跳转</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">nextPage</span><span class="params">(View view)</span></span>&#123;</div><div class="line">   showNextPage();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//点击上一页按钮的时候,根据子类的showPrePage方法做相应跳转</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prePage</span><span class="params">(View view)</span></span>&#123;</div><div class="line">   showPrePage();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="手机震动"><a href="#手机震动" class="headerlink" title="手机震动"></a>手机震动</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//手机震动效果(vibrator 震动)</span></div><div class="line">Vibrator vibrator = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);</div><div class="line"><span class="comment">//震动毫秒值</span></div><div class="line">vibrator.vibrate(<span class="number">2000</span>);</div><div class="line"><span class="comment">//规律震动(震动规则(不震动时间,震动时间,不震动时间,震动时间.......),重复次数)</span></div><div class="line">vibrator.vibrate(<span class="keyword">new</span> <span class="keyword">long</span>[]&#123;<span class="number">2000</span>,<span class="number">5000</span>,<span class="number">2000</span>,<span class="number">5000</span>&#125;, -<span class="number">1</span>);</div></pre></td></tr></table></figure>
<h3 id="播放声音"><a href="#播放声音" class="headerlink" title="播放声音"></a>播放声音</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//7,播放音乐(准备音乐,MediaPlayer)</span></div><div class="line">MediaPlayer mediaPlayer = MediaPlayer.create(context, R.raw.ylzs);</div><div class="line">mediaPlayer.setLooping(<span class="keyword">true</span>);</div><div class="line">mediaPlayer.start();</div></pre></td></tr></table></figure>
<h3 id="文本抖动效果"><a href="#文本抖动效果" class="headerlink" title="文本抖动效果"></a>文本抖动效果</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//res/anim/shake.xml</span></div><div class="line">&lt;translate xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span> </div><div class="line">    android:fromXDelta=<span class="string">"0"</span> </div><div class="line">    android:toXDelta=<span class="string">"10"</span> </div><div class="line">    android:duration=<span class="string">"1000"</span> </div><div class="line">    android:interpolator=<span class="string">"@anim/cycle_7"</span> /&gt;</div><div class="line">     </div><div class="line"><span class="comment">//cycle_7.xml</span></div><div class="line">&lt;cycleInterpolator xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span> android:cycles=<span class="string">"7"</span> /&gt;</div><div class="line">   </div><div class="line">Animation shake = AnimationUtils.loadAnimation(</div><div class="line">        getApplicationContext(), R.anim.shake);</div><div class="line">et_phone.startAnimation(shake);</div></pre></td></tr></table></figure>
<h3 id="获取手机所有应用相关信息"><a href="#获取手机所有应用相关信息" class="headerlink" title="获取手机所有应用相关信息"></a>获取手机所有应用相关信息</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 返回当前手机所有的应用的相关信息(名称,包名,图标,(手机内存,sd卡),(系统,用户));</div><div class="line"> * <span class="doctag">@param</span> ctx  获取包管理者的上下文环境</div><div class="line"> * <span class="doctag">@return</span> 包含手机安装应用相关信息的集合</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;AppInfo&gt; <span class="title">getAppInfoList</span><span class="params">(Context ctx)</span></span>&#123;</div><div class="line">   <span class="comment">//1,包的管理者对象</span></div><div class="line">   PackageManager pm = ctx.getPackageManager();</div><div class="line">   <span class="comment">//2,获取安装在手机上应用相关信息的集合</span></div><div class="line">   List&lt;PackageInfo&gt; packageInfoList = pm.getInstalledPackages(<span class="number">0</span>);</div><div class="line">   List&lt;AppInfo&gt; appInfoList = <span class="keyword">new</span> ArrayList&lt;AppInfo&gt;();</div><div class="line">   <span class="comment">//3,循环遍历应用信息的集合</span></div><div class="line">   <span class="keyword">for</span> (PackageInfo packageInfo : packageInfoList) &#123;</div><div class="line">      AppInfo appInfo = <span class="keyword">new</span> AppInfo();</div><div class="line">      <span class="comment">//4,获取应用的包名</span></div><div class="line">      appInfo.packageName = packageInfo.packageName;</div><div class="line">      <span class="comment">//5,应用名称</span></div><div class="line">      ApplicationInfo applicationInfo = packageInfo.applicationInfo;</div><div class="line">      appInfo.name = applicationInfo.loadLabel(pm).toString();</div><div class="line">      <span class="comment">//6,获取图标</span></div><div class="line">      appInfo.icon = applicationInfo.loadIcon(pm);</div><div class="line">      <span class="comment">//7,判断是否为系统应用(每一个手机上的应用对应的flag都不一致)</span></div><div class="line">      <span class="keyword">if</span>((applicationInfo.flags &amp; ApplicationInfo.FLAG_SYSTEM)==ApplicationInfo.FLAG_SYSTEM)&#123;</div><div class="line">         <span class="comment">//系统应用</span></div><div class="line">         appInfo.isSystem = <span class="keyword">true</span>;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">         <span class="comment">//非系统应用</span></div><div class="line">         appInfo.isSystem = <span class="keyword">false</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">//8,是否为sd卡中安装应用</span></div><div class="line">      <span class="keyword">if</span>((applicationInfo.flags &amp; ApplicationInfo.FLAG_EXTERNAL_STORAGE)==ApplicationInfo.FLAG_EXTERNAL_STORAGE)&#123;</div><div class="line">         <span class="comment">//系统应用</span></div><div class="line">         appInfo.isSdCard = <span class="keyword">true</span>;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">         <span class="comment">//非系统应用</span></div><div class="line">         appInfo.isSdCard = <span class="keyword">false</span>;</div><div class="line">      &#125;</div><div class="line">      appInfoList.add(appInfo);</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> appInfoList;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="九宫格GridView"><a href="#九宫格GridView" class="headerlink" title="九宫格GridView"></a>九宫格GridView</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//GridView</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="comment">//准备数据(文字(9组),图片(9张))</span></div><div class="line">   mTitleStrs = <span class="keyword">new</span> String[]&#123;</div><div class="line">         <span class="string">"手机防盗"</span>,<span class="string">"通信卫士"</span>,<span class="string">"软件管理"</span>,<span class="string">"进程管理"</span>,<span class="string">"流量统计"</span>,<span class="string">"手机杀毒"</span>,<span class="string">"缓存清理"</span>,<span class="string">"高级工具"</span>,<span class="string">"设置中心"</span></div><div class="line">   &#125;;</div><div class="line">   </div><div class="line">   mDrawableIds = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;</div><div class="line">         R.drawable.home_safe,R.drawable.home_callmsgsafe,</div><div class="line">         R.drawable.home_apps,R.drawable.home_taskmanager,</div><div class="line">         R.drawable.home_netmanager,R.drawable.home_trojan,</div><div class="line">         R.drawable.home_sysoptimize,R.drawable.home_tools,R.drawable.home_settings</div><div class="line">   &#125;;</div><div class="line">   <span class="comment">//九宫格控件设置数据适配器(等同ListView数据适配器)</span></div><div class="line">   gv_home.setAdapter(<span class="keyword">new</span> MyAdapter());</div><div class="line">   <span class="comment">//注册九宫格单个条目点击事件</span></div><div class="line">   gv_home.setOnItemClickListener(<span class="keyword">new</span> OnItemClickListener() &#123;</div><div class="line">      <span class="comment">//点中列表条目索引position</span></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; parent, View view,<span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</div><div class="line">         </div><div class="line">      &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="获取空间内存（运存）大小"><a href="#获取空间内存（运存）大小" class="headerlink" title="获取空间内存（运存）大小"></a>获取空间内存（运存）大小</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> ctx  </div><div class="line"> * <span class="doctag">@return</span> 返回可用的内存数    bytes</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getAvailSpace</span><span class="params">(Context ctx)</span></span>&#123;</div><div class="line">   <span class="comment">//1,获取activityManager</span></div><div class="line">   ActivityManager am = (ActivityManager) ctx.getSystemService(Context.ACTIVITY_SERVICE);</div><div class="line">   <span class="comment">//2,构建存储可用内存的对象</span></div><div class="line">   MemoryInfo memoryInfo = <span class="keyword">new</span> MemoryInfo();</div><div class="line">   <span class="comment">//3,给memoryInfo对象赋(可用内存)值</span></div><div class="line">   am.getMemoryInfo(memoryInfo);</div><div class="line">   <span class="comment">//4,获取memoryInfo中相应可用内存大小</span></div><div class="line">   <span class="keyword">return</span> memoryInfo.availMem;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> ctx  </div><div class="line"> * <span class="doctag">@return</span> 返回总的内存数 单位为bytes 返回0说明异常</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getTotalSpace</span><span class="params">(Context ctx)</span></span>&#123;</div><div class="line">   <span class="comment">/*//1,获取activityManager</span></div><div class="line">   ActivityManager am = (ActivityManager) ctx.getSystemService(Context.ACTIVITY_SERVICE);</div><div class="line">   //2,构建存储可用内存的对象</div><div class="line">   MemoryInfo memoryInfo = new MemoryInfo();</div><div class="line">   //3,给memoryInfo对象赋(可用内存)值</div><div class="line">   am.getMemoryInfo(memoryInfo);</div><div class="line">   //4,获取memoryInfo中相应可用内存大小</div><div class="line">   return memoryInfo.totalMem;*/</div><div class="line">   </div><div class="line">   <span class="comment">//内存大小写入文件中,读取proc/meminfo文件,读取第一行,获取数字字符,转换成bytes返回</span></div><div class="line">   FileReader fileReader  = <span class="keyword">null</span>;</div><div class="line">   BufferedReader bufferedReader = <span class="keyword">null</span>;</div><div class="line">   <span class="keyword">try</span> &#123;</div><div class="line">      fileReader= <span class="keyword">new</span> FileReader(<span class="string">"proc/meminfo"</span>);</div><div class="line">      bufferedReader = <span class="keyword">new</span> BufferedReader(fileReader);</div><div class="line">      String lineOne = bufferedReader.readLine();</div><div class="line">      <span class="comment">//将字符串转换成字符的数组</span></div><div class="line">      <span class="keyword">char</span>[] charArray = lineOne.toCharArray();</div><div class="line">      <span class="comment">//循环遍历每一个字符,如果此字符的ASCII码在0到9的区域内,说明此字符有效</span></div><div class="line">      StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">char</span> c : charArray) &#123;</div><div class="line">         <span class="keyword">if</span>(c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>)&#123;</div><div class="line">            stringBuffer.append(c);</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> Long.parseLong(stringBuffer.toString())*<span class="number">1024</span>;</div><div class="line">   &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">      e.printStackTrace();</div><div class="line">   &#125;<span class="keyword">finally</span>&#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">         <span class="keyword">if</span>(fileReader!=<span class="keyword">null</span> &amp;&amp; bufferedReader!=<span class="keyword">null</span>)&#123;</div><div class="line">            fileReader.close();</div><div class="line">            bufferedReader.close();</div><div class="line">         &#125;</div><div class="line">      &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="判断服务是否开启"><a href="#判断服务是否开启" class="headerlink" title="判断服务是否开启"></a>判断服务是否开启</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> ctx  上下文环境</div><div class="line"> * <span class="doctag">@param</span> serviceName 判断是否正在运行的服务</div><div class="line"> * <span class="doctag">@return</span> true 运行 false 没有运行</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isRunning</span><span class="params">(Context ctx,String serviceName)</span></span>&#123;</div><div class="line">   <span class="comment">//1,获取activityMananger管理者对象,可以去获取当前手机正在运行的所有服务</span></div><div class="line">   ActivityManager mAM = (ActivityManager) ctx.getSystemService(Context.ACTIVITY_SERVICE);</div><div class="line">   <span class="comment">//2,获取手机中正在运行的服务集合(多少个服务)</span></div><div class="line">   List&lt;RunningServiceInfo&gt; runningServices = mAM.getRunningServices(<span class="number">1000</span>);</div><div class="line">   <span class="comment">//3,遍历获取的所有的服务集合,拿到每一个服务的类的名称,和传递进来的类的名称作比对,如果一致,说明服务正在运行</span></div><div class="line">   <span class="keyword">for</span> (RunningServiceInfo runningServiceInfo : runningServices) &#123;</div><div class="line">      Log.i(tag, <span class="string">"runningServiceInfo.service.getClassName() = "</span>+runningServiceInfo.service.getClassName());</div><div class="line">      <span class="comment">//4,获取每一个真正运行服务的名称</span></div><div class="line">      <span class="keyword">if</span>(serviceName.equals(runningServiceInfo.service.getClassName()))&#123;</div><div class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="多击事件"><a href="#多击事件" class="headerlink" title="多击事件"></a>多击事件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">long</span>[] mHits = <span class="keyword">new</span> <span class="keyword">long</span>[<span class="number">3</span>];<span class="comment">//数组长度为点击次数</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 多次点击</div><div class="line"> * </div><div class="line"> * <span class="doctag">@param</span> view</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">	<span class="comment">//		src 源数组</span></div><div class="line">	<span class="comment">//		srcPos 开始拷贝的位置</span></div><div class="line">	<span class="comment">//		dst 目标数组</span></div><div class="line">	<span class="comment">//		dstPos 目标数组的起始拷贝位置</span></div><div class="line">	<span class="comment">//		length 拷贝的数组长度</span></div><div class="line">	System.arraycopy(mHits, <span class="number">1</span>, mHits, <span class="number">0</span>, mHits.length - <span class="number">1</span>);<span class="comment">//拷贝数组</span></div><div class="line">	mHits[mHits.length - <span class="number">1</span>] = SystemClock.uptimeMillis();</div><div class="line">	<span class="keyword">if</span> (mHits[<span class="number">0</span>] &gt;= (SystemClock.uptimeMillis() - <span class="number">500</span>)) &#123;</div><div class="line">		System.out.println(<span class="string">"是男人!!!"</span>);</div><div class="line">		mHits = <span class="keyword">new</span> <span class="keyword">long</span>[<span class="number">3</span>];</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://oxy.pub/2015/09/08/AndroidTinyPoint/" data-id="cjesjsttr00010tmwwfcyck9q" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Android/">Android</a></div><div class="post-nav"><a href="/2016/03/15/iOSVideoBlog/" class="pre">iOS音视频学习</a><a href="/2015/06/01/iOSTinyPoint/" class="next">iOS小知识点集锦</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://oxy.pub"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/“Android”/">“Android”</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Swift/" style="font-size: 15px;">Swift</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Objective-C/" style="font-size: 15px;">Objective-C</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/SSM/" style="font-size: 15px;">SSM</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/07/PLPlayerPackaging/">基于七牛播放器PLPlayer的二次封装(全屏) 以及七牛iOS播放器各个版本的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/niplayer/">一句话实现AVPlayer视频播放</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/11/Alamofire/">Alamofire4.4 网络请求的封装</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/11/GithubCode/">github优秀资源(iOS/Android/Java)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/08/autoRotate/">iOS状态栏旋转问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/Gradle-MyBatisGenerator/">Intellij IDEA 中结合 Gradle 使用 MyBatis Generator 逆向生成代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/ssm2/">intellij idea 2016 gradle搭建 spring + springMVC + mybatis 框架</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/22/ssm1/">intellij idea 2016 gradle搭建web工程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/15/iOSVideoBlog/">iOS音视频学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/08/AndroidTinyPoint/">安卓学习复习笔记</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/enamor" title="Github" target="_blank">Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">氧吧.</a><a rel="nofollow" target="_blank" href="https://oxy.pub"> nina.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>